@page "/voice-assistant"

<PageTitle>Asystent Głosowy</PageTitle>

<h3>Asystent Głosowy</h3>
<p>Kliknij "Nagraj" i zadaj pytanie głosem, potem "Stop". Następnie kliknij "Odpowiedz", by wysłać zapytanie do OpenAI. Odpowiedź zostanie wygenerowana i odtworzona głosowo.</p>
<div class="mb-3">
    <button class="btn btn-primary" @onclick="StartRecordingAsync" disabled="@_isRecording">Nagraj</button>
    <button class="btn btn-secondary" @onclick="StopRecordingAsync" disabled="@(!_isRecording)">Stop</button>
    <button class="btn btn-info" @onclick="ProcessQuestionAsync" disabled="@(_selectedAudio == null || _isLoading)">Odpowiedz</button>
</div>

@if (_isRecording)
{
    <p>Nagrywanie w toku...</p>
}

@if (_isLoading)
{
    <p>Przetwarzanie... proszę czekać.</p>
}

@if (_transcript != null)
{
    <h4>Pytanie:</h4>
    <p>@_transcript</p>
}

@if (_audioDataUrl != null)
{
    <h4>Odpowiedź (mowa):</h4>
    <audio controls>
        <source src="@_audioDataUrl" type="audio/wav" />
    </audio>
    <h4>Odpowiedź (tekst):</h4>
    <p>@_openAIResponse</p>
}